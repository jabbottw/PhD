<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Generator" content="Microsoft Word 97">
   <meta name="GENERATOR" content="Mozilla/4.5 [en] (Win98; U) [Netscape]">
   <title>Using DaVince Command Files (DCF)</title>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000FF" vlink="#800080" alink="#FF0000">

<center>
<h1>
Using DaVince Command Files (DCF)</h1></center>

<center>Version: 2.2
<p>Part of <a href="summary.html">DaVince Tools</a>
<br>Web Site: <a href="http://www.davince.com/">www.davince.com</a>
<p>Last Modified: July 22, 2003</center>

<h3>
Purpose</h3>
A DaVince command file (also known as a DCF file) is a text file that allows
a <b>DaVince Tools</b> converter to process command directives instead
of using the command line. This provides additional capability to <b>DaVince
Tools</b> that can not be found when specifying files and directories strictly
on the command line. Use of a command file has the following advantages
over the command line:
<ul>
<li>
Specifying files and or directories via a DCF file simplifies the command
line syntax and eliminates the problem of exceeding the command line buffer
when specifying a large number of files and/or directories.</li>

<li>
Multiple configuration profiles (specified in the ".ini" file) can be specified,
and individual settings of each profile can be modified during processing
of the command file. Conversely, only a single profile can be specified
on the command line.</li>

<li>
A DCF file can be used to watch one or more folders for conversion to PDF
using the "wait" and "goto" commands.</li>

<li>
An alternate name or alias can be given to a file for bookmark purposes,
allowing bookmarks to be created using descriptive text instead of the
name of the file. Specifying a blank name will prevent a bookmark from
being created for a particular file.</li>

<li>
The command file can be used as an application programming interface (API)
to the <b>DaVince Tools</b> converters. A programmer can write code that
generates a command file which can subsequently be used by a converter
to convert files to PDF. The command file is the application programming
interface (API) used by the Windows interface application, <a href="wdavince.html">wdavince</a>,
to send commands to a converter.</li>
</ul>

<h3>
Syntax</h3>
A DaVince command file consists of a series of lines entered in a text
file. The file can be created with a standard text editor like Notepad
or it can be generated by a program like <a href="wdavince.html">wdavince</a>.
Lines beginning with the pound character ( # ) or the single quote character
( ' ) are considered comments and are ignored. Special consideration is
given to the first line in the command file by the Windows program, <a href="wdavince.html">wdavince</a>.
If the first line begins with the two characters "#!" (a comment with an
exclamation point as the second character), the text in the line specifies
the converter to use when running the command file. For example, if the
command file started with the line:
<p><b><tt>#! txt2pdf</tt></b>
<p>then <a href="wdavince.html">wdavince</a> will run the command file
against the txt2pdf converter. This technique allows wdavince to save a
command file to disk and be able to run it at a later time against the
correct converter.
<p>The following commands are valid in the command file:
<p><b><tt>cd create dir echo file goto info param profile wait</tt></b>
<p>Refer to the <b>Command Description</b> section below for details on
the syntax for each command.
<p><b>Note:</b> When a filename or directory name is specified as a parameter
to one of the commands above, it must be enclosed in quotes if there is
a space character included in the name. For example, to convert files in
the "My Documents" directory, use the following command:
<p><b><tt># this is the correct way</tt></b>
<br><b><tt>dir "c:\My Documents</tt></b>"
<br>&nbsp;
<br>&nbsp;
<p>Instead of the following:
<p><b><tt># this is the WRONG way</tt></b>
<br><b><tt>dir c:\My Documents</tt></b>
<br>&nbsp;
<br>&nbsp;
<h3>
New in This Release</h3>
The following commands are new or modified in version 2.1:
<p><b><tt>create file goto wait</tt></b>
<p>The following commands were new in version 2.0:
<p><b><tt>create echo info param</tt></b>
<br>&nbsp;
<br>&nbsp;
<h3>
Command Summary</h3>

<table BORDER=0 CELLSPACING=0 CELLPADDING=7 WIDTH="638" >
<tr>
<td VALIGN=TOP WIDTH="50%">cd</td>

<td VALIGN=TOP WIDTH="50%">changes the current directory used by the "file"
and "dir" commands</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">create</td>

<td VALIGN=TOP WIDTH="50%">Specify the name of the PDF file to create</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">dir</td>

<td VALIGN=TOP WIDTH="50%">Convert specified directory</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">echo</td>

<td VALIGN=TOP WIDTH="50%">Echo text to the screen</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">file</td>

<td VALIGN=TOP WIDTH="50%">Convert specified file</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">goto</td>

<td VALIGN=TOP WIDTH="50%">Go to a specified label in the command file</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">info</td>

<td VALIGN=TOP WIDTH="50%">Add info strings to PDF file</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">param</td>

<td VALIGN=TOP WIDTH="50%">allows configuration parameters normally stored
in the .ini file to be included in the command file</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">profile</td>

<td VALIGN=TOP WIDTH="50%">Specify the profile to use as defined in the
INI file</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="50%">wait</td>

<td VALIGN=TOP WIDTH="50%">wait a specified # of seconds</td>
</tr>
</table>

<br>&nbsp;
<h3>
Command Description</h3>
&nbsp;The following section describes the commands. Command options in
square brackets ("[]") are optional. The vertical pipe character ("|")
specifies a choice of options. These characters are not actually used in
the command.
<p>
<hr>
<p><b><tt>cd <i>directoryname</i></tt></b>
<p>The "cd" command changes the current directory used by the "file" and
"dir" commands. This command is useful when many files are contained in
a single directory, which alleviates the need to prepend a path name to
a file when using the "file" command.
<p>
<hr>
<p><b><tt>create [ filename ] | [ dirname ] 1 [ force ] | [ dirname ] 2</tt></b>
<p>The format of this command varies depending on the conversion mode used:
many to one, one to one, or many to few. For many to one, only the PDF
file name to create need be specified. For one to one, an optional output
directory is specified along with the number "1". To force a PDF file to
be created in one to one mode, even if the file has not changed, specify
the keyword "force" after the "1" option. By default, the PDF file is not
created if the PDF file date is newer than the original data file. If an
output directory is not specified, then the PDF files are created in the
same directory as the files to be converted. For many to few, an optional
output directory is specified along with the number "2". If an output directory
is not specified, then the PDF files are created in the same directories
as the files to be converted.
<p>This command should be specified prior to the <b><tt>file</tt></b> or
<b><tt>dir</tt></b>
commands.
<p>A PDF file will not be created if the same filename with a ".LCK" extension
is found. For example, if the file "d:\conversion\myfile.lck" is present,
then the PDF file "d:\conversion\myfile.pdf" will not be created. This
lock file feature allows a program to temporarily disable converting to
PDF until all files are ready to be converted.
<p><b>Examples:</b>
<p>To convert many files to one to a file named "conversion.pdf", use the
following syntax:
<dir>
<dir><b><tt>create conversion.pdf</tt></b></dir>
</dir>
To convert files one to one, forcing a new PDF if one already exists, and
storing the PDF files in the same directories as the files to be converted,
use the following syntax:
<dir>
<dir><b><tt>create 1 force</tt></b></dir>
</dir>
To convert files many to few, and storing the PDF files in the same directories
as the files to be converted, use the following syntax:
<dir>
<dir><b><tt>create 2</tt></b></dir>
</dir>

<hr>
<p><b><tt>dir <i>directoryname</i> [<i>r</i>]</tt></b>
<p>The "dir" command specifies a directory to process. If an "r" is specified
for argument 2, then the directory is processed recursively (similar to
the "-r" command line option), otherwise, the directory is processed without
recursion. Directory names with spaces in them must be enclosed with quotes.
If a directory name contains a quote character, the quote must be preceded
with a backslash character.
<p>
<hr>
<p><b><tt>echo "text to display"</tt></b>
<p>or
<p><b><tt>echo text to display</tt></b>
<p>The "echo" command allows text to be displayed while processing the
command file. This is useful for displaying text to the user during processing
of the command file.
<p>
<hr>
<p><b><tt>file <i>filename</i> [<i>aliasname</i>]</tt></b>
<p>The "file" command specifies a file to convert. When an alias is specified
for argument 2, this name is used when creating the bookmark instead of
the filename. If the filename or the alias name contains spaces, then they
must be enclosed in quotes. If either contains a quote character, the quote
character must be preceded with a backslash character. If the alias name
is not specified, then a default bookmark name is used based on the filename.
If the bookmark name is specified as blank (two quotes only ""), then no
bookmark is generated for that file. This allows bookmarks to selectively
be created for certain files in the command file.
<p>New in version 2.1: The filename parameter can contain wild card characters.
If wildcards are specified, then the aliasname parameter is ignored and
a default bookmark name is used based on the filename.
<p>
<hr>
<p><b><tt>goto <i>label</i></tt></b>
<p>Use this command to jump to a specific location in the command file.
It is typically used in conjunction with the wait statement to monitor
a folder for new files. A label defines the location where a goto statement
can jump to. All labels must end in a colon (":") character. For example:
<p><b><tt>#! tiff2pdf</tt></b>
<br><b><tt>profile default</tt></b>
<br><b><tt>create 1</tt></b>
<br><b><tt># labels must end in a colon (":")</tt></b>
<br><b><tt>watchloop:</tt></b>
<br><b><tt>dir "e:\watchdir"</tt></b>
<br><b><tt># wait 60 seconds before trying again</tt></b>
<br><b><tt>wait 60</tt></b>
<br><b><tt>goto watchloop</tt></b>
<p>
<hr>
<p><b><tt>info <i>infokey</i> <i>infostring</i></tt></b>
<p>This command adds strings to the PDF info dictionary. This dictionary
contains information about the PDF file, including subject, author, and
title. The keys are case sensitive. infostring should be enclosed in quotes.
The command info keys are:
<p>Subject - the subject of the PDF file
<p>Author - the writer of the PDF file
<p>Title - The title of the PDF file
<br>&nbsp;
<br>&nbsp;
<p>
<hr>
<p><b><tt>param <i>paramkey paramstring</i></tt></b>
<p>The "param" command allows configuration parameters normally stored
in the .ini file to be included in the command file. This allows one to
create a profile dynamically or modify an existing profile by first using
the "profile" command.
<p>
<hr>
<p><b><tt>profile <i>profilename</i></tt></b>
<p>The "profile" command specifies the profile to use as defined in the
INI file. The profile name must be a valid profile. This option is similar
to the "-p" command line option, however, it allows for the profile to
change during the processing of the command file.
<p>
<hr>
<p><b><tt>wait <i>seconds</i></tt></b>
<p>Pause the execution of the command file for the specified number of
seconds. See the "goto" command for an example.
<p>
<hr>
<h3>
Example</h3>
<b><tt>#! txt2pdf</tt></b>
<br><b><tt># example command file for DaVince Tools txt2pdf</tt></b>
<br><b><tt># all comments start with ' or #</tt></b>
<br><b><tt># specify PDF filename</tt></b>
<br><b><tt>create systemfiles.pdf</tt></b>
<br><b><tt># specify profile from txt2pdf.ini</tt></b>
<br><b><tt>profile fixed-80x60</tt></b>
<br><b><tt># convert autoexec.bat</tt></b>
<br><b><tt>file c:\autoexec.bat</tt></b>
<br><b><tt># convert config.sys</tt></b>
<br><b><tt>file c:\config.sys</tt></b>
</body>
</html>
